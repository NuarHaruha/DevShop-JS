/**
 * Copyright (c) 2011 Roger Myrg http://devshop.me/
 * Released under the MIT license:
 * https://github.com/rgr-myrg/DevShop-JS/raw/master/MIT-LICENSE
 */
(function(){window.DevShop=typeof window.DevShop==="object"?window.DevShop:{};window.DevShop.Me=function(d){for(var c in d)d.hasOwnProperty(c)&&(window.DevShop[c]=d[c]);DevShop=devshop=window.DevShop}})();(function(){DevShop.Me({SingletonFactory:function(d){var c=function(a){if(typeof a==="function")try{return new a}catch(b){}else if(typeof a==="object")return a},e=c(d.implement),b=c(d.extend),c=c(d.instance),a;for(a in b)b.hasOwnProperty(a)&&(c[a]||(c[a]=b[a]));for(a in e)if(e.hasOwnProperty(a)&&!c[a])throw d.instance+" must implement '"+a+"' "+typeof e[a];if(typeof c.initialize==="function")try{c.initialize()}catch(g){}return c}})})();(function(){DevShop.Me({Observable:function(d){return DevShop.SingletonFactory({extend:function(){this.observers=[];this.addObserver=function(c){if((typeof c==="function"||typeof c==="object")&&typeof c.notify==="function")if(this.observers.push(c),typeof c.onRegister==="function")try{c.onRegister()}catch(d){}};this.notifyObservers=function(c){for(var d=this.observers.length,b=0;b<d;b++)try{this.observers[b].notify(c,this)}catch(a){}}},instance:d})}})})();(function(){DevShop.Me({Observer:function(d){return DevShop.SingletonFactory({extend:function(){this.onRegister=function(){};this.notify=function(c,d){this.observable=d;if(typeof this[c]==="function")try{this[c]()}catch(b){}}},instance:d})}})})();(function(){DevShop.Me({ProxyInterface:{NAME:""},MediatorInterface:{NAME:"",listNotificationInterests:function(){},handleNotification:function(){}},CommandInterface:{execute:function(){}},Proxy:function(){var d={};this.facade=null;this.setData=function(c){d=c};this.getData=function(){return d};this.onRegister=function(){};this.onRemove=function(){}},Mediator:new DevShop.Observer(function(){this.facade=null;this.onRegister=function(){};this.onRemove=function(){}}),Facade:function(){var d=new function(){var b=
{};this.facade={};this.registerProxy=function(a){a.facade=this.facade;b[a.NAME]||(b[a.NAME]=a);if(typeof a.onRegister==="function")a.onRegister()};this.retrieveProxy=function(a){return b[a]?b[a]:null};this.removeProxy=function(a){if(typeof b[a].onRemove==="function")try{b[a].onRemove()}catch(c){}b[a]=null}},c=new DevShop.Observable(function(){var b={};this.facade={};this.notification={};this.registerMediator=function(a){a.facade=this.facade;b[a.NAME]||(b[a.NAME]=a,this.addObserver(a))};this.retrieveMediator=
function(a){return b[a]?b[a]:null};this.removeMediator=function(a){if(typeof b[a].onRemove==="function")try{b[a].onRemove()}catch(c){}b[a]=null};this.notifyObservers=function(a){for(var b=this.observers.length,c=0;c<b;c++)try{for(var d=this.observers[c].listNotificationInterests(),e=!1,f=0;l=d.length,f<l;f++)if(d[f]==this.notification.name){e=!0;break}if(e)this.observers[c].notification=this.notification,this.observers[c].notify(a,this)}catch(h){}};this.sendNotification=function(a){this.notification=
a;this.notifyObservers("handleNotification")}}),e=new DevShop.Observer(function(){var b={},a=[];this.facade={};this.NAME="DevShop.Controller";this.registerCommand=function(c,d){d.facade=this.facade;b[c]||(b[c]=d,a.push(c))};this.listNotificationInterests=function(){return a};this.handleNotification=function(){var a=this.notification;if(typeof b[a.name]==="object"&&typeof b[a.name].execute==="function")try{b[a.name].execute(a)}catch(c){}}});this.CMD_STARTUP="CMD_STARTUP";this.registerProxy=function(b){d.registerProxy(b)};
this.registerMediator=function(b){c.registerMediator(b)};this.registerCommand=function(b,a){e.registerCommand(b,a)};this.retrieveProxy=function(b){return d.retrieveProxy(b)};this.retrieveMediator=function(b){return c.retrieveMediator(b)};this.removeProxy=function(b){d.removeProxy(b)};this.removeMediator=function(b){c.removeMediator(b)};this.sendNotification=function(b,a,d){c.sendNotification({name:b,body:a,type:d})};this.initializeFacade=function(){d.facade=this;c.facade=this;e.facade=this;this.registerMediator(e)}}})})();
